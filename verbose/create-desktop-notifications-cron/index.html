<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="description" content="


In my last post I talked about moving from Windows 10 to running i3 on Linux, built up from Debian Base System. Among other things, this change has taught me about the benefits of using basic tools and running a minimal, lightweight system. You can achieve a lot of functionality with just command line tools and simple utilities. One example I&rsquo;d like to illustrate in this post is setting up desktop notifications.


">

<meta property="og:title" content="


How I created custom desktop notifications using terminal and cron


">
<meta property="og:description" content="


In my last post I talked about moving from Windows 10 to running i3 on Linux, built up from Debian Base System. Among other things, this change has taught me about the benefits of using basic tools and running a minimal, lightweight system. You can achieve a lot of functionality with just command line tools and simple utilities. One example I&rsquo;d like to illustrate in this post is setting up desktop notifications.


">
<meta property="og:image" content="


https://vickylai.io/pixels/dunstnotif.png


">
<meta property="og:url" content="https://vickylai.io/verbose/create-desktop-notifications-cron/">

<meta name="twitter:image" content="


https://vickylai.io/pixels/dunstnotif.png


">
<meta name="twitter:card" content="summary_large_image">

<title>



    How I created custom desktop notifications using terminal and cron



</title>
<link rel="canonical" href="https://vickylai.io/verbose/create-desktop-notifications-cron/">

<link rel="stylesheet" href="/css/style.css">

<link href="https://fonts.googleapis.com/css?family=Didact+Gothic" rel="stylesheet"> 

<link rel="shortcut icon" href="/img/logo.ico" id="favicon">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-98623582-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-98623582-1');
</script>



<script
src="https://code.jquery.com/jquery-3.2.1.min.js"
integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
crossorigin="anonymous"></script>

</head><body><div id="top"></div><div class="blog-menu-mobile"><a href="/verbose">verbose</a> &#183;<a href="https://vickylai.io/">vickylai.io</a></div><div class="blog-menu no-mobile"><p><a href="/verbose">verbose</a> &#183;
<a href="/#work">work</a>

&#183; <a href="/#contact-box">contact</a>
&#183; <a href="https://vickylai.io/">vickylai.io</a></p><hr/></div><div class="wrap contain"><div id="featuredimg"><img src="/pixels/dunstnotif.png"/></div><div id="content"><h1>How I created custom desktop notifications using terminal and cron</h1>Tue Feb 21, 2017 &#183; 1073 words

<div><span id="tag"><a href="/tags/linux">linux</a></span><span id="tag"><a href="/tags/config">config</a></span><span id="tag"><a href="/tags/cron">cron</a></span><span id="tag"><a href="/tags/time-saver">time-saver</a></span></div><hr/>

<p>In my last post I talked about moving from Windows 10 to running i3 on Linux, built up from Debian Base System. Among other things, this change has taught me about the benefits of using basic tools and running a minimal, lightweight system. You can achieve a lot of functionality with just command line tools and simple utilities. One example I&rsquo;d like to illustrate in this post is setting up desktop notifications.</p>

<p>I use <a href="http://knopwob.org/dunst/">dunst</a> for desktop notifications. It&rsquo;s a simple, lightweight tool that is easy to configure, doesn&rsquo;t have many dependencies, and can be used across various distributions.</p>

<p><img src="/pixels/dunstnotif.png#center" alt="Screenshot of dunst in action!" /></p>

<h1 id="battery-status-low-battery-notification">Battery status/low battery notification</h1>

<p>I was looking for a simple, versatile set up to create notifications for my battery status without having to rely on separate, standalone GUI apps or services. In my search I came across a simple one-line cron task that seemed to be the perfect fit. I adapted it to my purpose and it looks like this:</p>

<pre><code class="language-conf"># m h  dom mon dow   command
*/5 * * * * acpi --battery | awk -F, '/Discharging/ { if (int($2) &lt; 20) print }' | xargs -ri env DISPLAY=:0 notify-send -u critical -i &quot;/usr/share/icons/Paper/16x16/status/xfce-battery-critical.png&quot; -t 3000 &quot;{}\nBattery low!&quot;
</code></pre>

<blockquote>
<p><em>Psst&hellip; <a href="https://crontab.guru/">here&rsquo;s a great tool</a> for formatting your crontab times.</em></p>
</blockquote>

<p>There&rsquo;s a lot going on here, so let&rsquo;s break it down:<br />
<code>*/5 * * * *</code><br />
Every five minutes, do the following.</p>

<p><code>acpi --battery</code><br />
Execute <code>acpi</code> and show battery information, which on its own returns something akin to:<br />
<code>Battery 0: Discharging, 65%, 03:01:27 remaining</code></p>

<p>Pretty straightforward so far. At any point you could input <code>acpi --battery</code> in a terminal and receive the status output. Today&rsquo;s post, however, is about receiving this information passively in a desktop notification. So, moving on:</p>

<p><code>| awk -F, '/Discharging/ { if (int($2) &lt; 20) print }'</code><br />
Pipe (<code>|</code>) the result of the previous command to <code>awk</code>. (If you don&rsquo;t know what pipe does, here&rsquo;s <a href="http://superuser.com/questions/756158/what-does-the-linux-pipe-symbol-do">an answer from superuser.com</a> that explains it pretty well, I think.) <code>awk</code> can do a lot of things, but in this case, we&rsquo;re using it to examine the status of our battery. Let&rsquo;s zoom in on the <code>awk</code> command:</p>

<p><code>awk -F, '/Discharging/ { if (int($2) &lt; 20) print }'</code><br />
Basically, we&rsquo;re saying, &ldquo;Hey, awk, look at that input you just got and try to find the word &ldquo;discharging,&rdquo; then look to see if the number after the first comma is less than 20. If so, print the whole input.&rdquo;</p>

<p><code>| xargs -ri</code><br />
Pipe the result of the previous command to <code>xargs</code>, which takes it as its input and does more stuff with it. <code>-ri</code> is equivalent to <code>-r</code> (run the next command only if it receives arguments) and <code>-i</code> (look for &ldquo;{}&rdquo; and replace it with the input). So in this example, xargs serves as our gatekeeper and messenger for the next command.</p>

<p><code>env DISPLAY=:0</code><br />
Run the following utility in the specified display, in this case, the first display of the local machine.</p>

<p><code>notify-send -u critical -i &quot;/usr/share/icons/Paper/16x16/status/xfce-battery-critical.png&quot; -t 3000 &quot;{}\nLow battery!&quot;</code><br />
Shows a desktop notification with <code>-u critical</code> (critical urgency), <code>-i</code> (the specified icon), <code>-t 3000</code> (display time/expires after 3000 milliseconds), and finally <code>{}</code> (the output of awk, replaced by xargs).</p>

<p>Not bad for a one-liner! I made a few modifications for different states of my battery. Here they all are in my crontab:</p>

<pre><code class="language-conf"># m h  dom mon dow   command
*/5 * * * * acpi --battery | awk -F, '/Discharging/ { if ( (int($2) &lt; 30) &amp;&amp; (int($2) &gt; 15) ) print }' | xargs -ri env DISPLAY=:0 notify-send -a &quot;Battery status&quot; -u normal -i &quot;/usr/share/icons/Paper/16x16/status/xfce-battery-low.png&quot; -t 3000 &quot;{}\nBattery low!&quot;
*/5 * * * * acpi --battery | awk -F, '/Discharging/ { if (int($2) &lt; 15) print }' | xargs -ri env DISPLAY=:0 notify-send -a &quot;Battery status&quot; -u critical -i &quot;/usr/share/icons/Paper/16x16/status/xfce-battery-critical.png&quot; -t 3000 &quot;{}\nSeriously, plug me in.&quot;
*/60 * * * * acpi --battery | awk -F, '/Discharging/ { if (int($2) &gt; 30) print }' | xargs -ri env DISPLAY=:0 notify-send -a &quot;Battery status&quot; -u normal -i &quot;/usr/share/icons/Paper/16x16/status/xfce-battery-ok.png&quot; &quot;{}&quot;
*/60 * * * * acpi --battery | awk -F, '/Charging/ { print }' | xargs -ri env DISPLAY=:0 notify-send -a &quot;Battery status&quot; -u normal -i &quot;/usr/share/icons/Paper/16x16/status/xfce-battery-ok-charging.png&quot; &quot;{}&quot;
*/60 * * * * acpi --battery | awk -F, '/Charging/ { if (int($2) == 100) print }' | xargs -ri env DISPLAY=:0 notify-send -a &quot;Battery status&quot; -u normal -i &quot;/usr/share/icons/Paper/16x16/status/xfce-battery-full-charging.png&quot; &quot;Fully charged.&quot;
</code></pre>

<p>By the way, you can open your crontab in the editor of your choice by accessing it as root from the <code>/var/spool/cron/crontabs/</code> directory. It&rsquo;s generally best practice however to make changes to your crontab with the command <code>crontab -e</code>.</p>

<p>You can see that each notification makes use of the <code>{}</code> placeholder that tells xargs to put its input there - except for the last one. This is interesting because in this case, we&rsquo;re only using <code>xargs -ri</code> as a kind of switch to present the notification. The actual information that was the input for xargs is not needed in the output in order to create a notification.</p>

<h1 id="additional-notifications-with-command-line-tools">Additional notifications with command line tools</h1>

<p>With cron and just a few combinations of simple command line tools, you can create interesting and useful notifications. Consider the following:</p>

<h2 id="periodically-check-your-dhcp-address">Periodically check your dhcp address</h2>

<pre><code>*/60 * * * * journalctl | awk -F: '/dhcp/ &amp;&amp; /address/ { print $5 }' | tail -1 | xargs -ri env DISPLAY=:0 notify-send -a &quot;dhcp address&quot; -u normal &quot;{}&quot;
</code></pre>

<p>Which does the following:<br />
<code>*/60 * * * *</code><br />
Every 60 minutes.</p>

<p><code>journalctl</code><br />
Take the contents of your system log.</p>

<p><code>| awk -F: '/dhcp/ &amp;&amp; /address/ { print $5 }'</code><br />
Find logs containing both &ldquo;dhcp&rdquo; and &ldquo;address&rdquo; and output the 5th portion as separated by &ldquo;:&rdquo; (the time field counts).</p>

<p><code>| tail -1</code><br />
Take the last line of the output.</p>

<p><code>| xargs -ri env DISPLAY=:0 notify-send -a &quot;dhcp address&quot; -u normal &quot;{}&quot;</code><br />
Create the desktop notification including the output.</p>

<h2 id="periodically-display-the-time-and-date">Periodically display the time and date</h2>

<pre><code>*/60 * * * * timedatectl status | awk -F\n '/Local time/ { print }' | xargs -ri env DISPLAY=:0 notify-send -a &quot;Current Time&quot; -u normal &quot;{}&quot;
</code></pre>

<h2 id="system-log-activity">System log activity</h2>

<p>You can also search your system logs (try <code>journalctl</code>) for any number of things using awk, enabling you to get periodic notifications of virtually any logged events.</p>

<p>&nbsp;</p>

<p>I hope this post has given you some idea about the endless possibilities of these simple utilities. Questions or issues? Let me know on Twitter: <a href="https://twitter.com/hivickylai">@hivickylai</a>.</p>

<p>Thanks for reading!</p>
<p>Like this post? <a href="https://twitter.com/intent/tweet?text=@hivickylai:%20I%20just%20read%20https%3a%2f%2fvickylai.io%2fverbose%2fcreate-desktop-notifications-cron%2f%20and..." onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">Tweet me about it!</a></p></div><div class="go-center"><hr/></div><div class="related"><h2>An algorithm thinks these posts are related...</h2><ul> <li><a href="/verbose/renaming-images/">Batch renaming images, including image resolution, with awk</a></li><li><a href="/verbose/turn-unity-into-tiling-windows-manager/">How I turned Unity into a tiling window manager</a></li><li><a href="/verbose/same-dropbox-dual-boot/">How I set up a single Dropbox folder on my dual-boot Windows and Linux system</a></li></ul></div><div class="footer"><a href="/"><img id="blog-avatar" src="/img/purple-avatar.png" width="120px"/></a><div id="bio">I&#39;m a nomadic developer who geeks out over 90s stuff and drinks too much coffee. My dream title is &#34;Lead Easter Egg Developer.&#34; This is where I put all the words that don&#39;t fit on Twitter.<div id="menu"><ul><li><a href="https://github.com/hivickylai">github</a></li>

&#183; <li><a href="https://twitter.com/hivickylai">twitter</a></li>
&#183; <li><a href="mailto:hello@vickylai.io" rel="noopener">email</a></li></ul></div></div></div>
<script>
    scrollTo = (element) => {
        window.scroll({
            behavior: 'smooth',
            left: 0,
            top: element.offsetTop
        });
    }

    document.getElementById("up").addEventListener('click', () => {
        scrollTo(document.getElementById("top"));
    });
</script></div></body>